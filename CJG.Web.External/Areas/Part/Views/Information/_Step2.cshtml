
<div ng-if="model.ParticipantInfoStep2ViewModel" ng-show="model.ParticipantInfoStep0ViewModel.Step == 2">
    <p class="subheader--step">Step 2 of {{model.ParticipantInfoStep0ViewModel.TotalSteps}}</p>
    <h2 class="subheader">Contact information</h2>

    @Html.TextBoxBlock(new FormControl
    {
        Id = "FirstName",
        Label = "First name <abbr title='Required'>*</abbr>",
        Model = "model.ParticipantInfoStep2ViewModel.FirstName",
        IsInnerModel = true,
        Options = "maxlength = '100'"
    })

    @Html.TextBoxBlock(new FormControl
    {
        Id = "MiddleName",
        Label = "Middle name",
        Model = "model.ParticipantInfoStep2ViewModel.MiddleName",
        IsInnerModel = true,
        Options = "maxlength = '100'"
    })

    @Html.TextBoxBlock(new FormControl
    {
        Id = "LastName",
        Label = "Last name <abbr title='Required'>*</abbr>",
        Model = "model.ParticipantInfoStep2ViewModel.LastName",
        IsInnerModel = true,
        Options = "maxlength = '100'"
    })

    @Html.DatePickerDropDownList(new DatePickerFormControl
    {
        Id = "birth-date",
        Date = "model.ParticipantInfoStep2ViewModel.DateOfBirth",
        IsRequired = true,
        Label = "Date of birth",
        StartYear = "{{calculatedYear(model.ParticipantInfoStep0ViewModel.AppDateTimeNow, -model.ParticipantInfoStep2ViewModel.ParticipantOldestAge)}}",
        EndYear = "{{calculatedYear(model.ParticipantInfoStep0ViewModel.AppDateTimeNow, -model.ParticipantInfoStep2ViewModel.ParticipantYoungestAge)}}"
    })

    <div class="form__group">
        <label class="form__label">Social Insurance <nobr>Number <abbr title="Required">*</abbr></nobr></label>

        <div class="form__control">
            <div class="form__group--sin validation-group">
                @Html.TextBox(new FormControl { CssClass = "ignored-field", Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.SIN1", Options = "maxlength = '3' ng-number" })
                <span class="spacer">-</span>
                @Html.TextBox(new FormControl { CssClass = "ignored-field", Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.SIN2", Options = "maxlength = '3' ng-number" })
                <span class="spacer">-</span>
                @Html.TextBox(new FormControl { CssClass = "ignored-field", Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.SIN3", Options = "maxlength = '3' ng-number" })
            </div>
            @Html.ValidationError("model.ParticipantInfoStep2ViewModel.SIN", true)
        </div>
    </div>

    <div class="form__group">
        <label class="form__label">Personal phone <nobr>number <abbr title="Required">*</abbr></nobr></label>
        <div class="form__control">
            <span class="form__group--tel validation-group">
                @Html.TextBox(new FormControl { Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.Phone1AreaCode", Options = "maxlength = '3'  ng-number" })
                <span class="spacer">-</span>
                @Html.TextBox(new FormControl { Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.Phone1Exchange", Options = "maxlength = '3'  ng-number" })
                <span class="spacer">-</span>
                @Html.TextBox(new FormControl { Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.Phone1Number", Options = "maxlength = '4'  ng-number" })
            </span>
            <span class="form__group--tel-ext">
                <label>Ext</label>
                @Html.TextBox(new FormControl { Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.Phone1Extension", Options = "maxlength = '10'  ng-number" })
            </span>
            @Html.ValidationError("model.ParticipantInfoStep2ViewModel.Phone1", true)
        </div>
    </div>

    <div class="form__group">
        <label class="form__label">Alternate phone number</label>
        <div class="form__control">
            <span class="form__group--tel validation-group">
                @Html.TextBox(new FormControl { Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.Phone2AreaCode", Options = "maxlength = '3' ng-number" })
                <span class="spacer">-</span>
                @Html.TextBox(new FormControl { Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.Phone2Exchange", Options = "maxlength = '3' ng-number" })
                <span class="spacer">-</span>
                @Html.TextBox(new FormControl { Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.Phone2Number", Options = "maxlength = '4' ng-number" })
            </span>
            <span class="form__group--tel-ext">
                <label>Ext</label>
                @Html.TextBox(new FormControl { Size = "input--small", Model = "model.ParticipantInfoStep2ViewModel.Phone2Extension", Options = "maxlength = '10' ng-number" })
            </span>
            @Html.ValidationError("model.ParticipantInfoStep2ViewModel.Phone2", true)
        </div>
    </div>

    @Html.TextBoxBlock(new FormControl { Id="EmailAddress", Label="Personal Email <abbr title='Required'>*</abbr>", Model = "model.ParticipantInfoStep2ViewModel.EmailAddress", IsInnerModel = true })

    @Html.TextBoxBlock(new FormControl { Id = "AddressLine1", Label = "Home address line 1 <abbr title='Required'>*</abbr>", Model = "model.ParticipantInfoStep2ViewModel.AddressLine1", IsInnerModel = true, Size="input--full" })

    @Html.TextBoxBlock(new FormControl { Id = "AddressLine2",  Label="Home address line 2", Model = "model.ParticipantInfoStep2ViewModel.AddressLine2", Size = "input--full" })

    @Html.TextBoxBlock(new FormControl { Id = "City", Label = "City <abbr title='Required'>*</abbr>", Model = "model.ParticipantInfoStep2ViewModel.City", IsInnerModel = true })

    @Html.DropDownList(new FormControl
    {
        Id = "RegionId",
        Label = "Province <abbr title='Required'>*</abbr>",
        Model = "model.ParticipantInfoStep2ViewModel.RegionId",
        Options = "item.Key as item.Value for item in model.ParticipantInfoStep2ViewModel.Provinces",
        CssClass = "input--medium",
        IsInnerModel = true
    })

    @Html.TextBoxBlock(new FormControl
    {
        Id = "PostalCode",
        Label = "Postal Code <abbr title='Required'>*</abbr>",
        Model = "model.ParticipantInfoStep2ViewModel.PostalCode",
        IsInnerModel = true,
        Size = "input--small",
        CustomAttributes = "maxlength='6' ng-postal"
    })

    @Html.IncludeCanadaPostAutoComplete()

    <br />
    <p>NEXT STEP: Demographic information</p>

    <script type="text/javascript">
        $(function () {
            addressComplete.setCulture('en-us');
            addressComplete.listen('load', function(control) {          
                control.listen("populate", function (address) {
                    document.getElementById("RegionId").value = "string:" + address.Province;
                });      
            }); 
        });
    </script>
 </div>
